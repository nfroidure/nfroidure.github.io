<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>InsertAfter : Detecting Bad JavaScript Performance Tests On JSPerf</title>
  <meta name="description" content="JSPerf gives us a simple way to write JavaScript performance tests.
 Unfortunately, tests found aren&#39;t always well designed. Here&#39;s how to detect
 and avoid them.">
  <link rel="bookmark" href="https://insertafter.com/en/blog/jsperf_use_with_caution.html" />
  <link rel="icon" type="image/png" href="/images/favicon.png" />
  <meta name="robots" content="index,follow">
  <link rel="stylesheet" href="/css/main.css">
  <link href='https://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>
  
</head>
<body class="ia-standalone">
  <!--[if lt IE 7]>
  <script>document.location.href=http://browsehappy.com;</script>
  <![endif]-->
  <header class="ia-header">
    <div class="ia-header__title">
      <h1><a href="/en/index.html" title="Back to home"
        class="ia-logo">
        <img src="/images/logo.svg" alt="Logo Insert After" />
      </a></h1>
    </div>
  </header>
  <nav class="ia-languages">
    <a class="ia-flag ia-flag--fr" href="/fr/index.html"
      title="Retour à l&#39;accueil">
      <span>Accueil</span>
    </a>
    <a class="ia-flag ia-flag--en" href="/en/index.html"
      title="Back to home"
      class="selected">
      <span>Home</span>
    </a>
  </nav>

  <nav class="ia-menu">
    <ul class="ia-menu__body">
      <li class="ia-menu__item ia-menu__item--index">
        <a href="/en/index.html"
          title="Back to home">Home</a>
      </li>
      <li class="ia-menu__item ia-menu__item--index">
        <a href="/en/blog/index.html"
          title="Back to home"
          class="selected">Blog</a>
      </li>
      <li class="ia-menu__item ia-menu__item--projects">
        <a href="/en/projects.html"
          title="Learn more about my projects">Projects</a>
      </li>
      <li class="ia-menu__item ia-menu__item--about">
        <a href="/en/about.html"
          title="Learn more about me">About</a>
      </li>
    </ul>
  </nav>

  <section class="ia-main ia-content">
    <div>
    
<article class="ia-main__content">
  

<h2>Detecting Bad JavaScript Performance Tests On JSPerf</h2>
<p>
  JSPerf gives us a simple way to write JavaScript performance tests.
  Unfortunately, tests found aren&#039;t always well designed. Here&#039;s how
  to detect and avoid them.
</p>

<p>
  When I discovered
  <a title="Create Performance tests" href="https://jsperf.com/">JSperf.com</a>,
  I was realy impressed by its ease of use. Writing JavaScript performance tests
  just became as simple as writing JavaScript&#0160;:). Knowing it, i&#039;m
  often looking for perf tests on it to quickly have an overview of results for
  a particular case.
</p>
<p>
  Sadly, it rarely fit my needs, whislt it often reflect a poor understanding of
  what performance testing means. Here is a summary of my experience with those
  tests, how to detect them and how to impeach them to lead developpers to
  mistakes.
</p>
<h3>When tests smell</h3>
<p>
  One particular case you should be aware of is the use of console.* methods.
  Thoses methods should never be found in a test since
  <a
    title="Look at a test on console.log speed"
    href="https://jsperf.com/console-log-performance/6"
    >they are really slow</a
  >
  and will tend to equalize test results especially for critical performance
  test. Unfortunately, it&#039;s very common to see
  <a
    href="https://www.google.com/search?q=site&#37;3Ajsperf.com++&#37;22console.log(&#37;22&amp;aq=f&amp;oq=site&#37;3Ajsperf.com++&#37;22console.log(&#37;22"
    >tests using console.log</a
  >.
</p>
<p>
  By the way, If you test something, test it <strong>only</strong>. The above
  console.log test&#039;s
  <a title="View one of them" href="https://jsperf.com/console-log-performance/2"
    >prior versions</a
  >
  were completely unusefull since they didn&#039;t test only console.log. The
  purpose of a test is to reveal the overhead of the tested feature, so you
  should find the smallest footprint possible for your wrapping code.
</p>
<p>
  Another problem with previous revisions of this test is usage of a for loop in
  order to make the test more &#034;massive&#034;: JSPerf do it for you, stop
  wasting your time.
</p>
<p>
  Another common issue is when code is valid, but not well formed. It often lead
  to strange test results. So, take time to read the test code if you plan to
  exploit it&#039;s results. Common mistakes of that kind are&#0160;:
</p>
<ul>
  <li>
    forgetting to execute a function (<code>myFunction;</code> instead of
    <code>myFunction();</code>),
  </li>
  <li>abnormal return or break instruction,</li>
  <li>bad logic,</li>
  <li>undefined identifiers,</li>
  <li>etc...</li>
</ul>
<p>
  Those mistakes are leading most of the time to better performances since some
  parts of the code aren&#039;t executed.
</p>
<p>
  Another way to detect bad tests is to look at later revisions, it sometimes
  add some tests but often fix them. All in all, if you do not want to spend
  time checking if a test is right, you can look after JavaScript Rockstars
  tests (Addy Osmani, John Resig, ...).
</p>
<h3>Avoid creating bad test</h3>
<p>
  Anyone can create a bad test, but there are some good practices to reduce the
  risk&#0160;:
</p>
<ul>
  <li>
    if you&#039;re a noob&#0160;: <strong>don&#039;t write tests,</strong>
  </li>
  <li>read your code many times before submitting,</li>
  <li>test your code in the JavaScript console first,</li>
  <li>
    if you made shit, mark it as shit (comment with a link to the modified
    revisions),
  </li>
  <li>
    if someone mark it as shit, don&#039;t be hurt. Testing is not about you,
    <strong>it&#039;s about truth</strong>.
  </li>
</ul>
<p>
  That&#039;s it, this post is over. If you&#039;ve got some other good
  practices or another way to detect bad tests let me know!
</p>

</article>
<nav class="ia-main__back">
  <a href="/en/blog/index.html"
    title="Nicolas Froidure&#39;s Blog, Fullstack JavaScript Developper">
    &lt; Blog
  </a>
</nav>

    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES * * */
      var disqus_shortname = 'insertafter';
      var disqus_config = function () {
        this.language = "en";
        this.callbacks.onNewComment = [function() {
          ga('send', 'event', 'interaction', 'comment');
        }];
      };

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    
    </div>
  </section>

  <aside class="ia-icons ia-content">
    <nav>
      <a href="https://twitter.com/nfroidure" title="Follow me on Twitter"
        class="ia-social ia-social--twitter">
        <span>Twitter</span>
      </a>
      <a href="https://github.com/nfroidure" title="Follow me on GitHub"
        class="ia-social ia-social--github">
        <span>GitHub</span>
      </a>
      <a href="https://www.npmjs.org/~nfroidure" title="Find NPM modules"
        class="ia-social ia-social--npm">
        <span>NPM</span>
      </a>
      <a href="https://www.linkedin.com/in/nfroidure" title="Find me on LinkedIn"
        class="ia-social ia-social--linkedin">
        <span>LinkedIn</span>
      </a>
      <a href="/en/blog/index.atom" title="Don't miss my blog posts"
        class="ia-social ia-social--feed">
        <span>ATOM feed</span>
      </a>
    </nav>
  </aside>

  <footer class="ia-footer">
    <p class="ia-footer__content">
      © Nicolas Froidure 2012-2021
    </p>
  </footer>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-21477946-7', 'insertafter.com');
    ga('send', 'pageview');

  </script>
</body>
</html>
