<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>InsertAfter : Revisiting The JavaScript Singleton Pattern</title>
  <meta name="description" content="JavaScript design patterns are quite good examples to sharp your
 JavaScript skills. Let&#39;s take a look to the singleton pattern.">
  <link rel="bookmark" href="https://insertafter.com/en/blog/revisiting_js_singleton_pattern.html" />
  <link rel="icon" type="image/png" href="/images/favicon.png" />
  <meta name="robots" content="index,follow">
  <link rel="stylesheet" href="/css/main.css">
  <link href='https://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>
  
</head>
<body class="ia-standalone">
  <!--[if lt IE 7]>
  <script>document.location.href=http://browsehappy.com;</script>
  <![endif]-->
  <header class="ia-header">
    <div class="ia-header__title">
      <h1><a href="/en/index.html" title="Back to home"
        class="ia-logo">
        <img src="/images/logo.svg" alt="Logo Insert After" />
      </a></h1>
    </div>
  </header>
  <nav class="ia-languages">
    <a class="ia-flag ia-flag--fr" href="/fr/index.html"
      title="Retour à l&#39;accueil">
      <span>Accueil</span>
    </a>
    <a class="ia-flag ia-flag--en" href="/en/index.html"
      title="Back to home"
      class="selected">
      <span>Home</span>
    </a>
  </nav>

  <nav class="ia-menu">
    <ul class="ia-menu__body">
      <li class="ia-menu__item ia-menu__item--index">
        <a href="/en/index.html"
          title="Back to home">Home</a>
      </li>
      <li class="ia-menu__item ia-menu__item--index">
        <a href="/en/blog/index.html"
          title="Back to home"
          class="selected">Blog</a>
      </li>
      <li class="ia-menu__item ia-menu__item--projects">
        <a href="/en/projects.html"
          title="Learn more about my projects">Projects</a>
      </li>
      <li class="ia-menu__item ia-menu__item--about">
        <a href="/en/about.html"
          title="Learn more about me">About</a>
      </li>
    </ul>
  </nav>

  <section class="ia-main ia-content">
    <div>
    
<article class="ia-main__content">
  

<h2>Revisiting The JavaScript Singleton Pattern</h2>
<p>
  ⚠ Beware: This article is outdated. I now think that inherance is often not a
  good pattern, I&#039;m rarely using POO in JavaScript currently too. I prefer
  functions composition and singleton factories that I combine thanks to depency
  injection and inversion of control with
  <a href="https://github.com/nfroidure/knifecycle">Knifecycle</a>.
</p>
<p>
  JavaScript design patterns are quite good examples to sharpen your JavaScript
  skills. Let&#039;s take a look at the singleton pattern.
</p>

<p>
  I&#039;m currently reading
  <a title="Follow him on Twitter" href="https://twitter.com/addyosmani"
    >Addy Osmani’s</a
  >
  <a
    title="Buy this book"
    href="http://shop.oreilly.com/product/0636920025832.do"
    >book about JavaScript design patterns</a
  >. It&#039;s a very interesting introduction and I strongly recommend you this
  read. Viewing his Singleton Pattern implementation I had two simple ideas of
  improvement to get them more powerful. Here is a basic implementation of this
  pattern:
</p>
<script
  type="text/javascript"
  src="https://gist.github.com/nfroidure/5676292.js"
></script>
<noscript
  ><pre>
// Singleton pattern var MySingleton=(function() &#123; // creating a variable to contain the instance var instance=null; // here goes private stuff var _myPrivateVar=1; var _myPrivateFunction=function()&#123; console.log(&#039;In private function.&#039;); &#125;; // creating singleton constructor function Constructor() &#123; // assigning instance to our variable instance=this; &#125; // here goes public method and properties Constructor.prototype.publicProperty=1; Constructor.prototype.publicMethod=function() &#123; console.log(&#039;In public method.&#039;); _myPrivateFunction(); &#125;; // creating a constructor to generate an exception var FakeContructor=function() &#123; throw SyntaxError(&#039;Singleton : Use getInstance instead.&#039;); &#125; // associating him getInstance() FakeContructor.getInstance=function()&#123; return instance || new Constructor(); &#125;; return FakeContructor; &#125;)();  // Usage var singleton=MySingleton.getInstance(); console.log(singleton===MySingleton.getInstance() &amp;&amp;singleton===MySingleton.getInstance() &amp;&amp;singleton===MySingleton.getInstance()); // true console.log(singleton.publicProperty); // 1 singleton.publicMethod(); // In public method. // In private function.   // Misuse attempts var singleton=new MySingleton(); // SyntaxError : Singleton : Use getInstance instead.</pre
  >
</noscript>
<p>
  To the Addy&#039;s implementation I just added a fake constructor in order to
  prevent misuses of the singleton pattern. As you can see, the Singleton
  pattern purpose is to ensure there will always be only one instance of
  it&#039;s &#034;class&#034;.
</p>
<p>
  After reading it I wondered if there could be a way to make singletons
  inherance possible. I finally got it by adding a simple snippet to the
  previous implementation
</p>
<script
  type="text/javascript"
  src="https://gist.github.com/nfroidure/5676346.js"
></script>
<noscript
  ><pre>
// Inherit JavaScript Singleton function ParentConstructor() &#123;&#125; ParentConstructor.prototype.publicProperty1=1;  var InheritSingleton=(function(parentConstructor) &#123; // creating a variable to contain the instance var instance=null; // creating singleton constructor function Constructor() &#123; // assigning instance to our variable instance=this; &#125; // adding parent object to the singleton constructor prototype function F() &#123;&#125; F.prototype = (parentConstructor.getInstance? parentConstructor.getInstance(): new parentConstructor());  Constructor.prototype=new F(); // here goes public method and properties Constructor.prototype.publicProperty2=2; Constructor.prototype.publicMethod2=function() &#123; console.log(&#039;In public method 2.&#039;); _myPrivateFunction(); &#125;; // creating a constructor to generate an exception var FakeContructor=function() &#123; throw SyntaxError(&#039;Singleton : Use getInstance instead.&#039;); &#125; // associating him getInstance() FakeContructor.getInstance=function()&#123; return instance || new Constructor(); &#125;; return FakeContructor; &#125;)(ParentConstructor);  // Usage var singleton=InheritSingleton.getInstance(); console.log(singleton.publicProperty1); // 1 console.log(singleton.publicProperty2); // 2</pre
  >
</noscript>
<p>
  As you can see our singleton inherits from the parent constructor we have
  given it. It also can take a conventional objet constructor or another
  singleton.
</p>
<p>
  The main use case for it is the ability to extend to another conventional
  constructor the singleton pattern. It also provide a way to extend existing
  singletons and change their behavior with no risk to alter them.
</p>

</article>
<nav class="ia-main__back">
  <a href="/en/blog/index.html"
    title="Nicolas Froidure&#39;s Blog, Fullstack JavaScript Developper">
    &lt; Blog
  </a>
</nav>

    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES * * */
      var disqus_shortname = 'insertafter';
      var disqus_config = function () {
        this.language = "en";
        this.callbacks.onNewComment = [function() {
          ga('send', 'event', 'interaction', 'comment');
        }];
      };

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    
    </div>
  </section>

  <aside class="ia-icons ia-content">
    <nav>
      <a href="https://twitter.com/nfroidure" title="Follow me on Twitter"
        class="ia-social ia-social--twitter">
        <span>Twitter</span>
      </a>
      <a href="https://github.com/nfroidure" title="Follow me on GitHub"
        class="ia-social ia-social--github">
        <span>GitHub</span>
      </a>
      <a href="https://www.npmjs.org/~nfroidure" title="Find NPM modules"
        class="ia-social ia-social--npm">
        <span>NPM</span>
      </a>
      <a href="https://www.linkedin.com/in/nfroidure" title="Find me on LinkedIn"
        class="ia-social ia-social--linkedin">
        <span>LinkedIn</span>
      </a>
      <a href="/en/blog/index.atom" title="Don't miss my blog posts"
        class="ia-social ia-social--feed">
        <span>ATOM feed</span>
      </a>
    </nav>
  </aside>

  <footer class="ia-footer">
    <p class="ia-footer__content">
      © Nicolas Froidure 2012-2021
    </p>
  </footer>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-21477946-7', 'insertafter.com');
    ga('send', 'pageview');

  </script>
</body>
</html>
